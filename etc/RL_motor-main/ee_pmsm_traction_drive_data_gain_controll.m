%% Parameters for Three-Phase PMSM Traction Drive Example

% This example shows how to control the rotor speed in a permanent magnet 
% synchronous machine (PMSM) based electrical-traction drive. A 
% high-voltage battery feeds the FEM-Parameterized PMSM block through 
% a controlled three-phase converter. A Rotational Friction block
% provides the load. The position and speed information are obtained
% by using a high-fidelity resolver. The PMSM controller subsystem 
% includes a cascade control structure which has an outer speed-control 
% loop and two inner current-control loops. During the 0.25 seconds 
% simulation, the rotor speed demand is ramped-up from 0 to 1000 rpm.

% Copyright 2018-2020 The MathWorks, Inc.

%% Machine Parameters
Pmax = 35000;      % Maximum power                      [W]   # 정격 power와는 다르다.
Tmax = 200;        % Maximum torque                     [N*m]
Ld   = 0.00024368; % Stator d-axis inductance           [H]
Lq   = 0.00029758; % Stator q-axis inductance           [H]
L0   = 0.00012184; % Stator zero-sequence inductance    [H]
Rs   = 0.010087;   % Stator resistance per phase        [Ohm]
psim = 0.044;      % Permanent magnet flux linkage      [Wb]
p    = 8;          % Number of pole pairs
Jm   = 0.1234;     % Rotor inertia                      [Kg*m^2]

% Stator current in q-axis
iqVec=[-425 -400 -375 -350 -325 -300 -275 -250 -225 -200 -175 -150 -125 -100 -75 -50 -25 0 25	50	75 100	125	150	175	200	225	250	275	300	325	350	375	400	425	]; % A peak
% Stator current in d-axis
idVec=[-250 -225 -200 -175 -150 -125 -100 -75 -50 -25 0 25 50 75 100 125 150 175 200 225 250]; % A peak
%-------------------------------------------------------------------------------------------------
% Permanent magnet flux linkage
PmMatrix=[ 0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
        0.0363 0.03709 0.0383 0.03951 0.04056 0.04161 0.04233 0.04305 0.043475 0.0439 0.04404 0.04418 0.044285 0.04439 0.04408 0.04385 0.04376	0.04366	0.04376	0.04385	0.04408	0.04439	0.044285 0.04418 0.04404 0.0439	0.043475 0.04305 0.04233 0.04161 0.04056 0.03951 0.0383	0.03709	0.0363;
      ];
%-------------------------------------------------------------------------------------------------
% Stator d-axis inductance
LdMatrix=[0.00018200  0.00019200 0.00019650 0.00020099 0.00020774 0.00021448 0.00022210 0.00022972 0.00023366 0.00023760 0.00024223 0.00024687 0.00026259 0.00027831 0.00026440 0.00025904 0.00026685	0.00024368	0.00026685	0.00025904	0.00026440	0.00027831	0.00026259	0.00024687	0.00024223	0.00023760	0.00023366	0.00022972	0.00022210	0.00021448	0.00020774	0.00020099	0.00019650	0.00019200	0.00018200;
        0.00018000  0.00018900 0.00019409 0.00019918 0.00020594 0.00021270 0.00021984 0.00022699 0.00023227 0.00023755 0.00024199 0.00024644 0.00025827 0.00027011 0.00026449 0.00026301 0.00026994	0.00027331	0.00026994	0.00026301	0.00026449	0.00027011	0.00025827	0.00024644	0.00024199	0.00023755	0.00023227	0.00022699	0.00021984	0.00021270	0.00020594	0.00019918	0.00019409	0.00018900	0.00018000;
        0.00017800  0.00018600 0.00019168 0.00019737 0.00020414 0.00021091 0.00021759 0.00022427 0.00023089 0.00023750 0.00024175 0.00024601 0.00025396 0.00026191 0.00026458 0.00026698 0.00027302	0.00030295	0.00027302	0.00026698	0.00026458	0.00026191	0.00025396	0.00024601	0.00024175	0.00023750	0.00023089	0.00022427	0.00021759	0.00021091	0.00020414	0.00019737	0.00019168	0.00018600	0.00017800;
        0.00017700  0.00018387 0.00018910 0.00019434 0.00020162 0.00020891 0.00021664 0.00022437 0.00022969 0.00023501 0.00024031 0.00024562 0.00024833 0.00025103 0.00026451 0.00026581 0.00025945	0.00027207	0.00025945	0.00026581	0.00026451	0.00025103	0.00024833	0.00024562	0.00024031	0.00023501	0.00022969	0.00022437	0.00021664	0.00020891	0.00020162	0.00019434	0.00018910	0.00018387	0.00017700;
        0.00017600  0.00018174 0.00018652 0.00019131 0.00019911 0.00020691 0.00021569 0.00022448 0.00022850 0.00023252 0.00023887 0.00024523 0.00024269 0.00024016 0.00026444 0.00026464 0.00024588	0.00024120	0.00024588	0.00026464	0.00026444	0.00024016	0.00024269	0.00024523	0.00023887	0.00023252	0.00022850	0.00022448	0.00021569	0.00020691	0.00019911	0.00019131	0.00018652	0.00018174	0.00017600;
        0.00017475  0.00017673 0.00018228 0.00018783 0.00019560 0.00020337 0.00021165 0.00021994 0.00022452 0.00022909 0.00023569 0.00024229 0.00024978 0.00025727 0.00026830 0.00028090 0.00024737	0.00022368	0.00024737	0.00028090	0.00026830	0.00025727	0.00024978	0.00024229	0.00023569	0.00022909	0.00022452	0.00021994	0.00021165	0.00020337	0.00019560	0.00018783	0.00018228	0.00017673	0.00017475;
        0.00017350  0.00017173 0.00017804 0.00018435 0.00019208 0.00019982 0.00020761 0.00021540 0.00022054 0.00022567 0.00023251 0.00023935 0.00025687 0.00027439 0.00027216 0.00029716 0.00024886	0.00020616	0.00024886	0.00029716	0.00027216	0.00027439	0.00025687	0.00023935	0.00023251	0.00022567	0.00022054	0.00021540	0.00020761	0.00019982	0.00019208	0.00018435	0.00017804	0.00017173	0.00017350;
        0.00017247  0.00016945 0.00017357 0.00017769 0.00018649 0.00019529 0.00020285 0.00021042 0.00021851 0.00022660 0.00023046 0.00023432 0.00025024 0.00026617 0.00027749 0.00027223 0.00022738	0.00022496	0.00022738	0.00027223	0.00027749	0.00026617	0.00025024	0.00023432	0.00023046	0.00022660	0.00021851	0.00021042	0.00020285	0.00019529	0.00018649	0.00017769	0.00017357	0.00016945	0.00017247;
        0.00017132  0.00016911 0.00017118 0.00017324 0.00018168 0.00019011 0.00019653 0.00020295 0.00021129 0.00021964 0.00022346 0.00022728 0.00024119 0.00025511 0.00027067 0.00028242 0.00032357	0.00027081	0.00032357	0.00028242	0.00027067	0.00025511	0.00024119	0.00022728	0.00022346	0.00021964	0.00021129	0.00020295	0.00019653	0.00019011	0.00018168	0.00017324	0.00017118	0.00016911	0.00017132;
        0.00016571  0.00016962 0.00016987 0.00017012 0.00017996 0.00018980 0.00019295 0.00019610 0.00020355 0.00021101 0.00020489 0.00019878 0.00022056 0.00024234 0.00026096 0.00027406 0.00036849	0.00015569	0.00036849	0.00027406	0.00026096	0.00024234	0.00022056	0.00019878	0.00020489	0.00021101	0.00020355	0.00019610	0.00019295	0.00018980	0.00017996	0.00017012	0.00016987	0.00016962	0.00016571;
        0.00016537  0.00017105 0.00016865 0.00016625 0.00017769 0.00018913 0.00018978 0.00019044 0.00019000 0.00018957 0.00021684 0.00024411 0.00023463 0.00022516 0.00024916 0.00027221 0.00033716	0.00032236	0.00033716	0.00027221	0.00024916	0.00022516	0.00023463	0.00024411	0.00021684	0.00018957	0.00019000	0.00019044	0.00018978	0.00018913	0.00017769	0.00016625	0.00016865	0.00017105	0.00016537;
        0.00016571  0.00016962 0.00016987 0.00017012 0.00017996 0.00018980 0.00019295 0.00019610 0.00020355 0.00021101 0.00020489 0.00019878 0.00022056 0.00024234 0.00026096 0.00027406 0.00036849	0.00015569	0.00036849	0.00027406	0.00026096	0.00024234	0.00022056	0.00019878	0.00020489	0.00021101	0.00020355	0.00019610	0.00019295	0.00018980	0.00017996	0.00017012	0.00016987	0.00016962	0.00016571;
        0.00017132  0.00016911 0.00017118 0.00017324 0.00018168 0.00019011 0.00019653 0.00020295 0.00021129 0.00021964 0.00022346 0.00022728 0.00024119 0.00025511 0.00027067 0.00028242 0.00032357	0.00027081	0.00032357	0.00028242	0.00027067	0.00025511	0.00024119	0.00022728	0.00022346	0.00021964	0.00021129	0.00020295	0.00019653	0.00019011	0.00018168	0.00017324	0.00017118	0.00016911	0.00017132;
        0.00017247  0.00016945 0.00017357 0.00017769 0.00018649 0.00019529 0.00020285 0.00021042 0.00021851 0.00022660 0.00023046 0.00023432 0.00025024 0.00026617 0.00027749 0.00027223 0.00022738	0.00022496	0.00022738	0.00027223	0.00027749	0.00026617	0.00025024	0.00023432	0.00023046	0.00022660	0.00021851	0.00021042	0.00020285	0.00019529	0.00018649	0.00017769	0.00017357	0.00016945	0.00017247;
        0.00017350  0.00017173 0.00017804 0.00018435 0.00019208 0.00019982 0.00020761 0.00021540 0.00022054 0.00022567 0.00023251 0.00023935 0.00025687 0.00027439 0.00027216 0.00029716 0.00024886	0.00020616	0.00024886	0.00029716	0.00027216	0.00027439	0.00025687	0.00023935	0.00023251	0.00022567	0.00022054	0.00021540	0.00020761	0.00019982	0.00019208	0.00018435	0.00017804	0.00017173	0.00017350;
        0.00017475  0.00017673 0.00018228 0.00018783 0.00019560 0.00020337 0.00021165 0.00021994 0.00022452 0.00022909 0.00023569 0.00024229 0.00024978 0.00025727 0.00026830 0.00028090 0.00024737	0.00022368	0.00024737	0.00028090	0.00026830	0.00025727	0.00024978	0.00024229	0.00023569	0.00022909	0.00022452	0.00021994	0.00021165	0.00020337	0.00019560	0.00018783	0.00018228	0.00017673	0.00017475;
        0.00017600  0.00018174 0.00018652 0.00019131 0.00019911 0.00020691 0.00021569 0.00022448 0.00022850 0.00023252 0.00023887 0.00024523 0.00024269 0.00024016 0.00026444 0.00026464 0.00024588	0.00024120	0.00024588	0.00026464	0.00026444	0.00024016	0.00024269	0.00024523	0.00023887	0.00023252	0.00022850	0.00022448	0.00021569	0.00020691	0.00019911	0.00019131	0.00018652	0.00018174	0.00017600;
        0.00017700  0.00018387 0.00018910 0.00019434 0.00020162 0.00020891 0.00021664 0.00022437 0.00022969 0.00023501 0.00024031 0.00024562 0.00024833 0.00025103 0.00026451 0.00026581 0.00025945	0.00027207	0.00025945	0.00026581	0.00026451	0.00025103	0.00024833	0.00024562	0.00024031	0.00023501	0.00022969	0.00022437	0.00021664	0.00020891	0.00020162	0.00019434	0.00018910	0.00018387	0.00017700;
        0.00017800  0.00018600 0.00019168 0.00019737 0.00020414 0.00021091 0.00021759 0.00022427 0.00023089 0.00023750 0.00024175 0.00024601 0.00025396 0.00026191 0.00026458 0.00026698 0.00027302	0.00030295	0.00027302	0.00026698	0.00026458	0.00026191	0.00025396	0.00024601	0.00024175	0.00023750	0.00023089	0.00022427	0.00021759	0.00021091	0.00020414	0.00019737	0.00019168	0.00018600	0.00017800;
        0.00018000  0.00018900 0.00019409 0.00019918 0.00020594 0.00021270 0.00021984 0.00022699 0.00023227 0.00023755 0.00024199 0.00024644 0.00025827 0.00027011 0.00026449 0.00026301 0.00026994	0.00027331	0.00026994	0.00026301	0.00026449	0.00027011	0.00025827	0.00024644	0.00024199	0.00023755	0.00023227	0.00022699	0.00021984	0.00021270	0.00020594	0.00019918	0.00019409	0.00018900	0.00018000;
        0.00018200  0.00019200 0.00019650 0.00020099 0.00020774 0.00021448 0.00022210 0.00022972 0.00023366 0.00023760 0.00024223 0.00024687 0.00026259 0.00027831 0.00026440 0.00025904 0.00026685	0.00024368	0.00026685	0.00025904	0.00026440	0.00027831	0.00026259	0.00024687	0.00024223	0.00023760	0.00023366	0.00022972	0.00022210	0.00021448	0.00020774	0.00020099	0.00019650	0.00019200	0.00018200;   
    ];
%-------------------------------------------------------------------------------------------------
% Stator q-axis inductance
LqMatrix=[ 0.00021700  0.00022200 0.00022894 0.00023589 0.00024313 0.00025037 0.00025738 0.00026440 0.00027070 0.00027699 0.00028386 0.00029073 0.00030892 0.00032711 0.00031524 0.00031424 0.00033129	0.00029758	0.00033129	0.00031424	0.00031524	0.00032711	0.00030892	0.00029073	0.00028386	0.00027699	0.00027070	0.00026440	0.00025738	0.00025037	0.00024313	0.00023589	0.00022894	0.00022200	0.00021700;
        0.00021700  0.00022300 0.00023005 0.00023710 0.00024462 0.00025212 0.00025877 0.00026543 0.00027351 0.00028159 0.00028824 0.00029488 0.00030938 0.00032388 0.00031963 0.00032690 0.00033968	0.00032708	0.00033968	0.00032690	0.00031963	0.00032388	0.00030938	0.00029488	0.00028824	0.00028159	0.00027351	0.00026543	0.00025877	0.00025212	0.00024462	0.00023710	0.00023005	0.00022300	0.00021700;
        0.00021700  0.00022400 0.00023116 0.00023832 0.00024610 0.00025388 0.00026017 0.00026645 0.00027632 0.00028619 0.00029261 0.00029904 0.00030985 0.00032066 0.00032402 0.00033956 0.00034807	0.00035658	0.00034807	0.00033956	0.00032402	0.00032066	0.00030985	0.00029904	0.00029261	0.00028619	0.00027632	0.00026645	0.00026017	0.00025388	0.00024610	0.00023832	0.00023116	0.00022400	0.00021700;
        0.00021700  0.00022384 0.00023095 0.00023805 0.00024672 0.00025540 0.00026381 0.00027222 0.00028111 0.00028999 0.00029749 0.00030499 0.00031180 0.00031861 0.00033516 0.00034699 0.00034390	0.00035991	0.00034390	0.00034699	0.00033516	0.00031861	0.00031180	0.00030499	0.00029749	0.00028999	0.00028111	0.00027222	0.00026381	0.00025540	0.00024672	0.00023805	0.00023095	0.00022384	0.00021700;
        0.00021700  0.00022368 0.00023073 0.00023778 0.00024735 0.00025692 0.00026745 0.00027799 0.00028589 0.00029379 0.00030236 0.00031094 0.00031375 0.00031655 0.00034630 0.00035442 0.00033973	0.00036325	0.00033973	0.00035442	0.00034630	0.00031655	0.00031375	0.00031094	0.00030236	0.00029379	0.00028589	0.00027799	0.00026745	0.00025692	0.00024735	0.00023778	0.00023073	0.00022368	0.00021700;
        0.00021450  0.00022092 0.00022924 0.00023755 0.00024684 0.00025613 0.00026693 0.00027774 0.00028712 0.00029650 0.00030629 0.00031609 0.00032480 0.00033352 0.00035723 0.00036737 0.00035368	0.00036458	0.00035368	0.00036737	0.00035723	0.00033352	0.00032480	0.00031609	0.00030629	0.00029650	0.00028712	0.00027774	0.00026693	0.00025613	0.00024684	0.00023755	0.00022924	0.00022092	0.00021450;
        0.00021200  0.00021817 0.00022774 0.00023732 0.00024632 0.00025533 0.00026641 0.00027750 0.00028835 0.00029921 0.00031022 0.00032124 0.00033586 0.00035048 0.00036816 0.00038033 0.00036763	0.00036591	0.00036763	0.00038033	0.00036816	0.00035048	0.00033586	0.00032124	0.00031022	0.00029921	0.00028835	0.00027750	0.00026641	0.00025533	0.00024632	0.00023732	0.00022774	0.00021817	0.00021200;
        0.00021150  0.00021683 0.00022615 0.00023546 0.00024560 0.00025575 0.00026555 0.00027535 0.00028375 0.00029215 0.00030875 0.00032536 0.00034221 0.00035907 0.00037423 0.00039756 0.00040352	0.00037573	0.00040352	0.00039756	0.00037423	0.00035907	0.00034221	0.00032536	0.00030875	0.00029215	0.00028375	0.00027535	0.00026555	0.00025575	0.00024560	0.00023546	0.00022615	0.00021683	0.00021150;
        0.00021022  0.00021631 0.00022594 0.00023556 0.00024456 0.00025357 0.00026499 0.00027642 0.00028453 0.00029264 0.00031146 0.00033028 0.00034845 0.00036662 0.00038422 0.00041376 0.00043111	0.00045697	0.00043111	0.00041376	0.00038422	0.00036662	0.00034845	0.00033028	0.00031146	0.00029264	0.00028453	0.00027642	0.00026499	0.00025357	0.00024456	0.00023556	0.00022594	0.00021631	0.00021022;
        0.00020790  0.00021545 0.00022596 0.00023648 0.00024449 0.00025250 0.00026324 0.00027397 0.00028649 0.00029901 0.00031555 0.00033209 0.00035173 0.00037137 0.00039474 0.00042139 0.00042223	0.00043469	0.00042223	0.00042139	0.00039474	0.00037137	0.00035173	0.00033209	0.00031555	0.00029901	0.00028649	0.00027397	0.00026324	0.00025250	0.00024449	0.00023648	0.00022596	0.00021545	0.00020790;
        0.00020461  0.00021359 0.00022253 0.00023147 0.00024056 0.00024965 0.00026057 0.00027149 0.00028429 0.00029708 0.00031041 0.00032375 0.00034886 0.00037398 0.00040142 0.00043142 0.00046501	0.00045675	0.00046501	0.00043142	0.00040142	0.00037398	0.00034886	0.00032375	0.00031041	0.00029708	0.00028429	0.00027149	0.00026057	0.00024965	0.00024056	0.00023147	0.00022253	0.00021359	0.00020461;
        0.00020790  0.00021545 0.00022596 0.00023648 0.00024449 0.00025250 0.00026324 0.00027397 0.00028649 0.00029901 0.00031555 0.00033209 0.00035173 0.00037137 0.00039474 0.00042139 0.00042223	0.00043469	0.00042223	0.00042139	0.00039474	0.00037137	0.00035173	0.00033209	0.00031555	0.00029901	0.00028649	0.00027397	0.00026324	0.00025250	0.00024449	0.00023648	0.00022596	0.00021545	0.00020790;
        0.00021022  0.00021631 0.00022594 0.00023556 0.00024456 0.00025357 0.00026499 0.00027642 0.00028453 0.00029264 0.00031146 0.00033028 0.00034845 0.00036662 0.00038422 0.00041376 0.00043111	0.00045697	0.00043111	0.00041376	0.00038422	0.00036662	0.00034845	0.00033028	0.00031146	0.00029264	0.00028453	0.00027642	0.00026499	0.00025357	0.00024456	0.00023556	0.00022594	0.00021631	0.00021022;
        0.00021150  0.00021683 0.00022615 0.00023546 0.00024560 0.00025575 0.00026555 0.00027535 0.00028375 0.00029215 0.00030875 0.00032536 0.00034221 0.00035907 0.00037423 0.00039756 0.00040352	0.00037573	0.00040352	0.00039756	0.00037423	0.00035907	0.00034221	0.00032536	0.00030875	0.00029215	0.00028375	0.00027535	0.00026555	0.00025575	0.00024560	0.00023546	0.00022615	0.00021683	0.00021150;
        0.00021200  0.00021817 0.00022774 0.00023732 0.00024632 0.00025533 0.00026641 0.00027750 0.00028835 0.00029921 0.00031022 0.00032124 0.00033586 0.00035048 0.00036816 0.00038033 0.00036763	0.00036591	0.00036763	0.00038033	0.00036816	0.00035048	0.00033586	0.00032124	0.00031022	0.00029921	0.00028835	0.00027750	0.00026641	0.00025533	0.00024632	0.00023732	0.00022774	0.00021817	0.00021200;
        0.00021450  0.00022092 0.00022924 0.00023755 0.00024684 0.00025613 0.00026693 0.00027774 0.00028712 0.00029650 0.00030629 0.00031609 0.00032480 0.00033352 0.00035723 0.00036737 0.00035368	0.00036458	0.00035368	0.00036737	0.00035723	0.00033352	0.00032480	0.00031609	0.00030629	0.00029650	0.00028712	0.00027774	0.00026693	0.00025613	0.00024684	0.00023755	0.00022924	0.00022092	0.00021450;
        0.00021700  0.00022368 0.00023073 0.00023778 0.00024735 0.00025692 0.00026745 0.00027799 0.00028589 0.00029379 0.00030236 0.00031094 0.00031375 0.00031655 0.00034630 0.00035442 0.00033973	0.00036325	0.00033973	0.00035442	0.00034630	0.00031655	0.00031375	0.00031094	0.00030236	0.00029379	0.00028589	0.00027799	0.00026745	0.00025692	0.00024735	0.00023778	0.00023073	0.00022368	0.00021700;
        0.00021700  0.00022384 0.00023095 0.00023805 0.00024672 0.00025540 0.00026381 0.00027222 0.00028111 0.00028999 0.00029749 0.00030499 0.00031180 0.00031861 0.00033516 0.00034699 0.00034390	0.00035991	0.00034390	0.00034699	0.00033516	0.00031861	0.00031180	0.00030499	0.00029749	0.00028999	0.00028111	0.00027222	0.00026381	0.00025540	0.00024672	0.00023805	0.00023095	0.00022384	0.00021700;
        0.00021700  0.00022400 0.00023116 0.00023832 0.00024610 0.00025388 0.00026017 0.00026645 0.00027632 0.00028619 0.00029261 0.00029904 0.00030985 0.00032066 0.00032402 0.00033956 0.00034807	0.00035658	0.00034807	0.00033956	0.00032402	0.00032066	0.00030985	0.00029904	0.00029261	0.00028619	0.00027632	0.00026645	0.00026017	0.00025388	0.00024610	0.00023832	0.00023116	0.00022400	0.00021700;
        0.00021700  0.00022300 0.00023005 0.00023710 0.00024462 0.00025212 0.00025877 0.00026543 0.00027351 0.00028159 0.00028824 0.00029488 0.00030938 0.00032388 0.00031963 0.00032690 0.00033968	0.00032708	0.00033968	0.00032690	0.00031963	0.00032388	0.00030938	0.00029488	0.00028824	0.00028159	0.00027351	0.00026543	0.00025877	0.00025212	0.00024462	0.00023710	0.00023005	0.00022300	0.00021700;
        0.00021700  0.00022200 0.00022894 0.00023589 0.00024313 0.00025037 0.00025738 0.00026440 0.00027070 0.00027699 0.00028386 0.00029073 0.00030892 0.00032711 0.00031524 0.00031424 0.00033129	0.00029758	0.00033129	0.00031424	0.00031524	0.00032711	0.00030892	0.00029073	0.00028386	0.00027699	0.00027070	0.00026440	0.00025738	0.00025037	0.00024313	0.00023589	0.00022894	0.00022200	0.00021700;  
    ];  

%% High-Voltage System Parameters
Cdc  = 0.001;      % DC-link capacitor [F]
Vnom = 325;        % Nominal DC voltage[V]      # in RL_Traction_motor/PMSM controller/Outer loop control/PMSM Current Reference Generator parameter
V1   = 290;        % Voltage V1(< Vnom)[V]      # Where?

%% Control Parameters
Ts   = 5e-6;       % Fundamental sample time            [s] % 
fsw  = 10e3;       % PMSM drive switching frequency     [Hz] % 스위칭 주파수, 전류제어 대역폭 선정에 영향을 미침.
Tsc  = 1e-4;       % Sample time for control [s]

Kp_id = 0.8779;     % Proportional gain id controller
Ki_id = 710.3004;   % Integrator gain id controller
Kp_iq = 1.0744;     % Proportional gain iq controller
Ki_iq = 1.0615e+03; % Integrator gain iq controller

Kp_omega = 20;      % Proportional gain velocity controller
Ki_omega = 500;     % Integrator gain velocity controller